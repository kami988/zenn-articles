---
title: "VSCodeでdocker-compose.ymlをPrettierから回避する"
emoji: "🙈"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["docker", "vscode", "prettier"]
published: false
---

## はじめに

VSCode + Docker + Prettier + Next.js + ... といった環境で開発している際、`docker-compose.yml`は例外として設定しようとしたら、大分しょうもないところでつまずいたので、書き留めておきます。

## 問題

VSCodeを使う際、とりあえずPrettierを入れて以下のようにシングルクォーテーションを有効にして、settings.jsonでファイル保存時にフォーマットするように設定しています。

```json:.prettierrc
{
  "singleQuote": true,
  ...
}
```

```json:.vscode/settings.json
{
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.formatOnSave": true,
  ...
}
```

ただこのままだと、PrettierはYAMLも対象になっているため`docker-compose.yml`内の`""`が`''`に変換されてしまいます。
正直これでも動きはするのですが、[公式のコード](https://docs.docker.com/compose/)を見ると`""`で書かれているので、なるべく合わせたいわけです。

個別設定で[YAML専用のフォーマッター](https://marketplace.visualstudio.com/items?itemName=redhat.vscode-yaml)に変えようと以下のように変更したところ、困った事に反映されませんでした😇。

```diff json:.vscode/settings.json
{
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.formatOnSave": true,
+  "[YAML]": {
+    "editor.defaultFormatter": "redhat. scode-yaml"
+  }
  ...
}
```

## 解決

どうやら個別設定の際には`YAML`と`docker-compose.yml`は別物として認識されるようです。
ということはdocker専用のフォーマッターがあるのかなと思ったら、[Microsoftの拡張機能のDocker](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker)にフォーマッターが付いていたので、最終的に下のように書き換えて万事解決しました。

```json:.vscode/settings.json
{
  "editor.defaultFormatter": "esbenp.prettier-vscode",
  "editor.formatOnSave": true,
  "[dockercompose]": {
    "editor.defaultFormatter": "ms-azuretools.vscode-docker"
  }
  ...
}
```
